<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/app/static/css/template.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#alumno').select2({
                placeholder: "Select students",
                allowClear: true
            });
            // Handle item selection
            $('#alumno').on('select2:select', function (e) {
                const selectedId = e.params.data.id;
                const selectedText = e.params.data.text;

                // Add the selected item to the table
                $('#matriculas-container .table tbody').append(`
                    <tr data-id="${selectedId}">
                        <input type="hidden" name="alumnos-ids[]" value="${selectedId}">
                        <td>
                            <input type="text" class="form-control" name="matricula_nombre[]" value="${selectedText}" readonly>
                        </td>
                        <td>
                            <input type="text" class="form-control" name="matricula_correo[]" value="example@mail.com" readonly>
                        </td>
                        <td>
                            <button type="button" class="btn btn-danger btn-sm btn-remove-lab">Eliminar</button>
                        </td>
                    </tr>
                `);

                // Remove the selected item from the dropdown
                const option = $(this).find(`option[value="${selectedId}"]`);
                option.remove();
                $(this).trigger('change'); // Update Select2
            });

            // Handle item removal from the table
            $(document).on('click', '.btn-remove-lab', function () {
                const row = $(this).closest('tr');
                const id = row.data('id');
                const name = row.find('input[name="matricula_nombre[]"]').val();

                // Remove the row from the table
                row.remove();

                // Add the item back to the dropdown
                $('#alumno').append(new Option(name, id));

                // the dropdown
                const options = $('#alumno option');
                options.sort((a, b) => a.text.localeCompare(b.text));
                $('#alumno').html(options);
                $('#alumno').trigger('change'); // Update Select2Sort 
            });
        });
    </script>
    <!-- <script src="/app/static/js/template.js"></script> -->

    <style>
        .container {
            margin-top: 2rem;
            margin-bottom: 2rem;

            padding-left: 8rem;
            padding-right: 8rem;
        }

        .btn-outline-danger {
            /* background-color: #C01E1B; */
            border-color: #C01E1B;
            color: #C01E1B;
        }
    </style>
</head>

<body>
    <!-- Formulario para crear asignaturas y sus laboratorios -->
    <div class="container">
        <main>
            <h3>Crear Asignatura</h3>
            <hr>
            <!-- Pdf viewer -->
            <embed src="../../flask_uploads/Informe_Intermedio_TrejoSegadorAlberto_Subject_1_lab1_1736341227_0a4335c5.pdf" type="application/pdf" width="100%" height="600px" />
        </main>
    </div>
</body>

</html>